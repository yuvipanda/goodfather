<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="3.5" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
	<PropertyGroup>
		<OutputFileName>Models.dll</OutputFileName>
	</PropertyGroup>
  <ItemGroup>
	  <Definition Include="*.rdef" Exclude="Templates.rdef" />
	  <Compile Include="@(Definition -> '%(Filename).cs')" />
	  <References Include="System.Data.SQLite.dll" />
	  <References Include="Models.Core.dll" />
  </ItemGroup>
  <Target Name="Generate" Inputs="@(Definition)" Outputs="@(Compile)">
	  <Exec Command="ruby modelgen.rb cs_sqlite_xml.gen %(Definition.Filename).rdef %(Definition.Filename).cs" />
	  <Message Text="Generated %(Definition.Filename).cs from %(Definition.Filename).rdef" />
  </Target>
  <Target Name="Build" DependsOnTargets="Generate" Inputs="@(Compile)" Outputs="Models.dll">
	  <Csc Sources="@(Compile)" OutputAssembly="$(OutputFileName)" References="@(References)" TargetType="library" />
	  <Message Text="Built $(OutputFileName)" />
	  <Delete Files="@(Compile)" />
  </Target>
  <Target Name="Clean">
	  <Delete Files="$(OutputFileName)" />
  </Target>

</Project>
